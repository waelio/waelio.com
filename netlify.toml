[build]
  command = "node -v && pnpm -v && pnpm install --frozen-lockfile --prefer-offline && pnpm generate"
  publish = "dist"

[build.environment]
  # Ensure Netlify uses a modern Node (22 preferred, 20 allowed)
  NODE_VERSION = "22"
  PNPM_VERSION = "10.10.0"
  NUXT_TELEMETRY_DISABLED = "1"
  # So installs won't fail on engine checks in CI
  NPM_CONFIG_ENGINE_STRICT = "false"
  PNPM_ENGINE_STRICT = "false"

[[redirects]]
  from = "/sw.js"
  to = "/sw.js"
  status = 200

[[headers]]
  for = "/_nuxt/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/*"
  [headers.values]
    cache-control = "max-age=31536000, immutable"
